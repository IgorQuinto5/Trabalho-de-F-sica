<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <title>Portais</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        body {
            overflow: hidden;
        }

        #cenario {
            background-image: url('starry-space-vector-background-pixel-art-pixel-space-8-bit-700-236638267.jpg');
            background-size: cover;
            background-repeat: repeat-x;
            background-position: 0 0;
            width: 100vw;
            height: 100vh;
            position: relative;
            font-family: Arial, sans-serif;
        }

        #titulo-portais {
            position: absolute;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 35px;
            font-weight: bold;
            text-shadow: 2px 2px 5px black;
            z-index: 10;
            user-select: none;
        }

        #nave {
            width: 60px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: transform 0.1s;
            z-index: 2;
        }

        #chama {
            width: 30px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-70%, -50%);
            display: none;
            z-index: 1;
        }

        .portal {
            width: 160px;
            height: 140px;
            position: absolute;
            z-index: 1;
        }

        /* Portais no centro de cada lado */
        #portal-top {
            top: 50%;
            left: 10%;
            transform: translateY(-50%);
        }

        #portal-bottom {
            top: 50%;
            left: 35%;
            transform: translateY(-50%);
        }

        #portal-left {
            top: 50%;
            left: 55%;
            transform: translateY(-50%);
        }

        #portal-right {
            top: 50%;
            left: 80%;
            transform: translateY(-50%);
        }

        /* Balão de mensagem acima do portal */
        #balão-portal {
            position: absolute;
            background: rgba(255, 255, 255, 0.75);
            color: rgb(0, 0, 0);
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 14px;
            pointer-events: none;
            white-space: nowrap;
            display: none;
            z-index: 5;
            user-select: none;
        }

        /* Botão Voltar */
        #botao-voltar {
            position: absolute;
            bottom: 20px;
            left: 20px;
            padding: 10px 15px;
            background-color: rgb(255, 255, 255);
            color: rgb(0, 0, 0);
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            z-index: 20;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }

        #botao-voltar:hover {
            background-color: rgba(216, 216, 216, 0.9);
            transform: scale(1.03);
        }
    </style>
</head>

<body>
    <div id="cenario">

        <h1 id="titulo-portais">Portais de Aprendizado</h1>
        <!-- Portais -->
        <img id="portal-top" class="portal" src="output-onlinegiftools14-ezgif.com-crop.gif" alt="Portal Topo">
        <img id="portal-bottom" class="portal" src="output-onlinegiftools14-ezgif.com-crop.gif" alt="Portal Inferior">
        <img id="portal-left" class="portal" src="output-onlinegiftools14-ezgif.com-crop.gif" alt="Portal Esquerda">
        <img id="portal-right" class="portal" src="output-onlinegiftools14-ezgif.com-crop.gif" alt="Portal Direita">

        <!-- Nave e chama -->
        <img id="chama" src="output-onlinegiftools (12).gif" alt="Chama do Foguete">
        <img id="nave" src="nave-removebg-preview.png" alt="Nave Espacial">

        <!-- Balão dinâmico para portais -->
        <div id="balão-portal">Aperte "E" para entrar!</div>

        <!-- Botão Voltar -->
        <button id="botao-voltar" onclick="window.location.href='index3.html'">Voltar</button>
    </div>

    <script>
        const nave = document.getElementById('nave');
        const chama = document.getElementById('chama');
        const cenario = document.getElementById('cenario');
        const balão = document.getElementById('balão-portal');
        const portais = document.querySelectorAll('.portal');

        const velocidade = 4;
        let direcaoAtual = 'direita';
        let jogoAcabou = false;

        const teclasPressionadas = {
            ArrowUp: false,
            ArrowDown: false,
            ArrowLeft: false,
            ArrowRight: false
        };

        document.addEventListener('keydown', (e) => {
            if (e.key in teclasPressionadas) {
                teclasPressionadas[e.key] = true;
            }
            if ((e.key === 'e' || e.key === 'E') && balão.style.display === 'block') {
                let portalAtual = null;
                for (const portal of portais) {
                    if (colisao(nave, portal)) {
                        portalAtual = portal.id;
                        break;
                    }
                }
                switch (portalAtual) {
                    case 'portal-top':
                        window.location.href = 'index5.html';
                        break;
                    case 'portal-bottom':
                        window.location.href = 'index6.html';
                        break;
                    case 'portal-left':
                        window.location.href = 'index7.html';
                        break;
                    case 'portal-right':
                        window.location.href = 'index8.html';
                        break;
                    default:
                        alert("Erro: Portal desconhecido!");
                }
            }
        });

        document.addEventListener('keyup', (e) => {
            if (e.key in teclasPressionadas) {
                teclasPressionadas[e.key] = false;
            }
        });

        function colisao(el1, el2) {
            const r1 = el1.getBoundingClientRect();
            const r2 = el2.getBoundingClientRect();
            return !(
                r1.top > r2.bottom ||
                r1.bottom < r2.top ||
                r1.left > r2.right ||
                r1.right < r2.left
            );
        }

        function moverNave() {
            if (jogoAcabou) return;

            const cenarioWidth = cenario.clientWidth;
            const cenarioHeight = cenario.clientHeight;
            const naveWidth = nave.clientWidth;
            const naveHeight = nave.clientHeight;

            let top = parseInt(getComputedStyle(nave).top);
            let left = parseInt(getComputedStyle(nave).left);

            let movendo = false;

            if (teclasPressionadas.ArrowUp && top > 0) {
                nave.style.top = (top - velocidade) + 'px';
                movendo = true;
            }
            if (teclasPressionadas.ArrowDown && top < cenarioHeight - naveHeight) {
                nave.style.top = (top + velocidade) + 'px';
                movendo = true;
            }
            if (teclasPressionadas.ArrowLeft && left > 0) {
                nave.style.left = (left - velocidade) + 'px';
                movendo = true;
                if (direcaoAtual !== 'esquerda') {
                    nave.style.transform = 'translate(-50%, -50%) scaleX(-1)';
                    chama.style.transform = 'translate(70%, -40%) scaleX(1)';
                    direcaoAtual = 'esquerda';
                }
            }
            if (teclasPressionadas.ArrowRight && left < cenarioWidth - naveWidth) {
                nave.style.left = (left + velocidade) + 'px';
                movendo = true;
                if (direcaoAtual !== 'direita') {
                    nave.style.transform = 'translate(-50%, -50%) scaleX(1)';
                    chama.style.transform = 'translate(-175%, -40%) scaleX(-1)';
                    direcaoAtual = 'direita';
                }
            }

            chama.style.top = nave.style.top;
            chama.style.left = nave.style.left;
            chama.style.display = movendo ? 'block' : 'none';

            let emPortal = false;
            for (const portal of portais) {
                if (colisao(nave, portal)) {
                    emPortal = true;
                    const rect = portal.getBoundingClientRect();
                    const cenarioRect = cenario.getBoundingClientRect();
                    const balaoX = rect.left + rect.width / 2 - cenarioRect.left;
                    const balaoY = rect.top - cenarioRect.top - balão.offsetHeight - 10;
                    balão.style.left = balaoX + 'px';
                    balão.style.top = balaoY + 'px';
                    break;
                }
            }
            balão.style.display = emPortal ? 'block' : 'none';

            requestAnimationFrame(moverNave);
        }

        moverNave();

        let posFundo = 0;
        function animarParallax() {
            if (jogoAcabou) return;
            posFundo -= 0.5;
            cenario.style.backgroundPosition = `${posFundo}px 0`;
            requestAnimationFrame(animarParallax);
        }

        animarParallax();
    </script>

</body>
</html>
